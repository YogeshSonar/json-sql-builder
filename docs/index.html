<!DOCTYPE html><html><head><title>json-sql-builder</title><meta charset="utf-8"><meta name="description" content="Documentation json-sql-builder"><meta name="viewport" content="width=device-width initial-scale=1"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic" type="text/css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" integrity="sha256-t2/7smZfgrST4FS1DT0bs/KotCM74XlcqZN5Vu7xlrw=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css"><link rel="stylesheet" href="lib/style/style.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/1.1.0/highlightjs-line-numbers.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery-slimScroll/1.3.8/jquery.slimscroll.min.js"></script><script src="lib/main.js"></script><script src="data.json"></script></head><body><div class="w3-overlay w3-hide-large w3-animate-opacity" id="sidenavOverlay" onclick="closeSidenav()" style="cursor:pointer;"></div><nav class="w3-sidenav w3-collapse w3-white w3-card-2" id="sidenavMenu" style="z-index:3;width:250px;overflow:hidden;"><div class="brand w3-theme-dark" id="brand-sidenav"><span><img src="./lib/img/json160.gif" style="width:210px; position:fixed; top:15px; left:20px;"><img src="./lib/img/sql-logo1.png" style="width:180px; position:fixed; left:97px; top:80px;"><div class="planetarydev">SQL</div></span></div><div id="menuScrollArea"><a class="menu-top menu-item depth-0 active" href="index.html">Home</a><a class="menu-top menu-item depth-1" href="licence.html">Licence</a><a class="menu-top menu-item depth-1" href="roadmap.html">Roadmap</a><div id="api"><div class="menu-top">Helpers</div></div><a class="menu-item depth-1" href="Helpers-Aggregation.html">Aggregation</a><a class="menu-item depth-1" href="Helpers-Basics.html">Basics</a><a class="menu-item depth-1" href="Helpers-Comparison.html">Comparison</a><a class="menu-item depth-1" href="Helpers-JSON.html">JSON</a><a class="menu-item depth-1" href="Helpers-Logical.html">Logical</a><a class="menu-item depth-1" href="Helpers-Sorting.html">Sorting</a><div id="api"><div class="menu-top">DDL</div></div><a class="menu-item depth-1" href="DDL-CreateIndex.html">CreateIndex</a><a class="menu-item depth-1" href="DDL-CreateTable.html">CreateTable</a><a class="menu-item depth-1" href="DDL-CreateView.html">CreateView</a><div id="api"><div class="menu-top">Querying</div></div><a class="menu-item depth-1" href="Querying-Delete.html">Delete</a><a class="menu-item depth-1" href="Querying-Insert.html">Insert</a><a class="menu-item depth-1" href="Querying-Select.html">Select</a><a class="menu-item depth-1" href="Querying-Update.html">Update</a><div id="api"><div class="menu-top">Api</div></div><a class="menu-item depth-1" href="Api-SQLBuilder.html">SQLBuilder</a><div id="api"><div class="menu-top">Functions</div></div><a class="menu-item depth-1" href="Functions-String.html">String</a><div id="api">&nbsp;</div><div id="api">&nbsp;</div></div></nav><div class="w3-main main-content"><div class="w3-top w3-container w3-padding-16 w3-theme w3-large" id="topHeader"><i class="fa fa-bars w3-opennav w3-hide-large w3-xlarge w3-margin-left w3-margin-right" onclick="openSidenav()"></i><span class="w3-hide" id="titleSmall">json-sql-builder</span><input class="w3-input w3-right" id="searchInput" type="text" placeholder="Search"><nav class="w3-dropnav w3-card-4 w3-theme" id="dropSearch" style="display:none;"><div class="w3-container w3-theme-l5"><span class="w3-closebtn w3-xlarge" onclick="closeDropSearch()" title="Close Searchresults">&times</span></div><div class="w3-row-padding w3-padding-bottom w3-theme-l5" id="searchResults"><h4>Results</h4><div id="scrollAreaSearchResults"><ul class="w3-ul"></ul></div></div></nav></div><header class="w3-container w3-padding-64 w3-theme" style="padding-left:32px;"><h1 class="w3-xxxlarge w3-padding-16 w3-text-white" id="title">json-sql-builder</h1></header><div class="w3-container w3-padding-32" style="padding-left:32px;"><div class="main-content-container"><div><h1 id="jsonsqlbuilder">json-sql-builder</h1>
<p>Writing your SQL-Queries in a way like mongo. Use JSON to define all the queries you like to run.</p>
<p>By default <code>json-sql-builder</code> supports the ANSI-SQL language. In addition to this you can specify a dialect like <code>mysql</code> or <code>postgreSQL</code>.
At this time we will support additional language helpers and operators for:</p>
<ul>
<li class="task-list-item" style="list-style-type: none;"><input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;" checked> ANSI</li>
<li class="task-list-item" style="list-style-type: none;"><input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;" checked> MySQL</li>
<li class="task-list-item" style="list-style-type: none;"><input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;" checked> PostgreSQL</li>
<li class="task-list-item" style="list-style-type: none;"><input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"> Oracle</li>
<li class="task-list-item" style="list-style-type: none;"><input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"> Microsoft SQL Server</li>
</ul>
<p>For further details on the language specific helpers and operators have a look at the complete
documentation at <a href="https://planetarydev.github.io/json-sql-builder/">https://planetarydev.github.io/json-sql-builder/</a>.</p>
<h2 id="currentdevstage">Current Dev Stage</h2>
<p>The developing of this module is currently still in work, for details have a look at the <a href="https://planetarydev.github.io/json-sql-builder/roadmap.html">roadmap</a>. If you like to support the current development feel free and contribute on github. Any pull requests are welcome if you supply:</p>
<ul>
<li>Tests</li>
<li>Documentation</li>
<li>Support backward compatibility</li>
</ul>
<h2 id="install">Install</h2>
<pre><code class="sh language-sh">npm install json-sql-builder --save
</code></pre>
<h2 id="gettingstarted">Getting Started</h2>
<pre><code class="javascript language-javascript">const SQLBuilder = require('json-sql-builder');
// create a new instance of the SQLBuilder and load the language extension for mysql
var sqlbuilder   = new SQLBuilder('mysql');

// lets start some query fun
var totalSalary = sqlbuilder.build({
    $select: {
        $columns: [
            'job_title',
            { total_salary: { $sum: 'salary' } }
        ],
        $from: 'people',
        $where: {
            job_title: { $in: ['Sales Manager', 'Account Manager'] },
            age: { $gte: 18 },
            country_code: 'US',
        },
        $groupBy: ['job_title'],
    }
});
</code></pre>
<p><strong>Result</strong></p>
<pre><code class="javascript language-javascript">// totalSalary.sql
SELECT
    `job_title`,
    SUM(`salary`) AS `total_salary`
FROM
    `people`
WHERE
    `job_title` IN (?, ?)
AND `age` &gt;= ?
AND `country_code` = ?
GROUP BY
    `job_title`

// totalSalary.values
['Sales Manager', 'Account Manager', 18, 'US']


// general output
queryOutput = {
    sql: 'Your SQL-query-string'
    values: ['Array', 'with', 'all', 'Query-values']
    timeout: 10000 // depends on the options
}
</code></pre>
<h1 id="releasenotes">Release notes</h1>
<h3 id="101718bugfixingupdatedocs">1.0.17+18 Bugfixing, Update docs</h3>
<ul>
<li>Parameterized queries for PostgreSQL using $create operator. The params will now safely escaped by pg-format because PostgreSQL does not support parameters on CREATE statements.</li>
</ul>
<h3 id="1016addcreateviewsupportwithnewoperatorsandhelpers">1.0.16 Add <code>CREATE VIEW</code> Support with new operators and helpers</h3>
<ul>
<li>ANSI using <code>$create: { $view: 'myView', $select: {...} }</code></li>
</ul>
<pre><code class="javascript language-javascript">var query = sqlbuilder.build({
    $create: {
        $view: { $cor: 'v_people' },
        $select : {
            $from: 'people',
            $columns: [
                'first_name',
                'last_name'
            ]
        }
    }
});

// OUTPUT
CREATE OR REPLACE VIEW `v_people` AS
    SELECT
        `first_name`,
        `last_name`
    FROM
        `people`;
</code></pre>
<h3 id="1015addsupportforansijoinoperators">1.0.15 Add Support for ANSI <code>JOIN</code> operators</h3>
<ul>
<li>INNER JOIN</li>
<li>LEFT JOIN</li>
<li>RIGHT JOIN</li>
<li>FULL OUTER JOIN</li>
</ul>
<pre><code class="javascript language-javascript">var query = sqlbuilder.build({
    $select: {
        $from: 'public.users',
        $joins: {
            'public.users_profiles': { $as: 'profile', $innerJoin: { 'public.users.id': { $eq: { $column: 'profile.user_id' } } } },
            'public.users_likes': { $as: 'likes',
                $leftJoin: {
                    $and: [
                        { 'likes.user_id': { $eq: { $column: 'public.users.id' } } },
                        { 'likes.score': { $gt: 1 } }
                    ]
                }
            }
        }
    }
});
</code></pre>
<h3 id="1015addpostgresqljsonhelpers">1.0.15 Add PostgreSQL JSON helpers</h3>
<ul>
<li>$rowToJson</li>
<li>$jsonBuildObject</li>
</ul>
<pre><code class="javascript language-javascript">// Example using $jsonBuildObject
var query = sqlbuilder.build({
    $select: { $columns: [
        { peopleData: { $jsonBuildObject: { firstName: 'John', lastName: 'Doe' } } }
    ] }
});

SELECT
    json_build_object('firstName', $1, 'lastName', $2) AS "peopleData"
FROM
    "people"


// Example using $rowToJson
var query = sqlbuilder.build({
    $select: {
        $from: 'people',
        $columns: [
            { peopleData: { $rowToJson: 'people' } }
        ]
    }
});

SELECT
    row_to_json("people") AS "peopleData"
FROM
    "people";
</code></pre>
<h3 id="1014addcreateindexoperatorsandhelpersfor">1.0.14 Add <code>CREATE INDEX</code> operators and helpers for</h3>
<ul>
<li>ANSI using <code>$create: { $index: 'myidx', $table: 'mytable', $columns: {...} }</code></li>
<li>Move <code>$ine</code> to Basic Helpers and support Boolean and String expressions</li>
<li>Update tests and docs</li>
</ul>
<pre><code class="javascript language-javascript">var query = sqlbuilder.build({
    $create: {
        $index: 'idx_people_last_name',
        $table: 'people',
        $columns: {
            last_name: { $asc: true },
            first_name: { $asc: true },
        },
        $using: 'BTREE'
    }
}

// OUTPUT
CREATE INDEX `idx_people_last_name` ON `people` USING BTREE (
    `last_name` ASC,
    `first_name` ASC
);
</code></pre>
<h3 id="1013addcreatetableoperatorsandhelpersfor">1.0.13 Add <code>CREATE TABLE</code> operators and helpers for</h3>
<ul>
<li>ANSI</li>
<li>PostgreSQL</li>
<li>MySQL</li>
<li>Update tests and docs</li>
</ul>
<pre><code class="javascript language-javascript">var query = sqlbuilder.build({
    $create: {
        $table: 'users',
        $define: {
            _id: { $column: { $type: 'VARCHAR', $length: 32, $notNull: true } },
            username: { $column: { $type: 'TEXT' } },
            first_name: { $column: { $type: 'TEXT' } },
            last_name: { $column: { $type: 'TEXT', $default: 'John' } },
            createdAt: { $column: { $type: 'DATETIME', $notNull: true } },

            pk_users: { $constraint: { $primary: true, $columns: '_id' } },
            uc_users_username: { $constraint: { $unique: true, $columns: 'username' } }
        }
    }
});

// OUTPUT
CREATE TABLE `users` (
    `_id` VARCHAR (32) NOT NULL,
    `username` TEXT,
    `first_name` TEXT,
    `last_name` TEXT DEFAULT ?,
    `createdAt` DATETIME NOT NULL,

    CONSTRAINT `pk_users` PRIMARY KEY (`_id`),
    CONSTRAINT `uc_users_username` UNIQUE (`username`)
);
</code></pre>
<h3 id="1012addhelpersandoperatorsforpostgresql">1.0.12 Add helpers and operators for <strong>postgreSQL</strong></h3>
<ul>
<li><code>LIMIT</code> and <code>LIMIT ALL</code> using <code>$limit</code></li>
<li><code>OFFSET</code> using <code>$offset</code></li>
<li>add <code>sqlDialect</code> property to sqlBuilder to use it inside of helper-functions</li>
</ul>
<h3 id="1011addhelpersandoperatorsforpostgresql">1.0.11 Add helpers and operators for <strong>postgreSQL</strong></h3>
<ul>
<li><code>ON CONFLICT</code> clause using <code>$confict</code></li>
<li>Update documetation</li>
</ul>
<h3 id="1010addhelpersandoperatorsforpostgresql">1.0.10 Add helpers and operators for <strong>postgreSQL</strong></h3>
<ul>
<li>Function <code>json_agg()</code> using <code>$jsonAgg</code></li>
<li>Function <code>to_json()</code> using <code>$json</code></li>
</ul></div></div></div><br><br><br><br><br><br><br><br><br><br><br><br><footer class="w3-container w3-padding-32 w3-theme" style="padding-left:32px;"><h5>Generated by planetarydev:planetdocs</h5><p>Licence MIT</p><span class="thanks"></span></footer></div></body><script>//hljs.initHighlightingOnLoad();
//hljs.initLineNumbersOnLoad();</script></html>